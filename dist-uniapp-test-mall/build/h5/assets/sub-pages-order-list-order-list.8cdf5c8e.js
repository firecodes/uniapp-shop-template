import{Q as e,p as t,d as a,s as l,R as s,$ as r,a1 as u,q as o,v as n,o as i,c,w as d,h as f,F as p,r as y,u as m,a as b,b as v,t as _,P as x,A as k,K as w,e as g,n as C,g as h,i as j,j as S,av as N,m as T,k as I,N as M,O as P,S as q}from"./index.1710046744346.js";import{_ as z}from"./uni-load-more.60f29a80.js";import{_ as A}from"./app-scroll-view.25475bf7.js";import{k as O,f as $,i as F}from"./order.e513a513.js";import{_ as K}from"./plugin-vueexport-helper.6cd7b27f.js";import"./isObjectLike.53204146.js";import"./useSystem.fcc01766.js";import"./request.ff2c352d.js";const L=e("order",(()=>{const e=t("0");return{currentType:e,setCurrentType:t=>{e.value=t}}}),{persist:!0}),Q=K(a({__name:"order-list-item",props:{type:null},setup(e){const a=e,N={1:"待付款",2:"待发货",3:"待收货",4:"待评价",5:"已完成",6:"已取消"},T=t("more"),I=L(),{currentType:M}=l(I),P=t([]),q=t(1),K=t(10);async function Q(e){if(T.value="loading",r({title:"加载中..."}),M.value!==a.type)return;const{result:t}=await O({page:q.value,pageSize:K.value,orderState:e});if(q.value>=t.pages)return T.value="noMore",void u();P.value=[...P.value,...t.items],q.value++,T.value="more",u()}s(M,(()=>{q.value,P.value=[],Q(Number(a.type))}),{immediate:!0});const R=async()=>{"loading"!=T.value&&await Q(Number(a.type))};return(e,t)=>{const l=h,s=j,r=S,u=o(n("uni-load-more"),z),I=o(n("app-scroll-view"),A);return i(),c(I,{scrolltolower:R,"refresher-enabled":!1},{default:d((()=>[(i(!0),f(p,null,y(m(P),(e=>(i(),c(l,{class:"bg-white m-2 rounded-1 mb-2 p-2",key:e.id},{default:d((()=>[b(l,{onClick:t=>{return a=e.id,void C({url:`/sub-pages/order-detail/order-detail?id=${a}`});var a}},{default:d((()=>[b(l,{class:"text-[#999] between text-sm"},{default:d((()=>[b(l,null,{default:d((()=>[v(_(e.createTime),1)])),_:2},1024),b(l,{class:"center-y"},{default:d((()=>[b(l,null,{default:d((()=>[v(_(N[e.orderState]),1)])),_:2},1024),6==e.orderState||4==e.orderState?(i(),c(l,{key:0,class:"ml-1 center-y order-list-item-delete"},{default:d((()=>[b(l,{class:"i-carbon-delete",onClick:x((t=>(async e=>{w({content:"确定要删除该订单吗？",confirmColor:"#fbb957",success:async t=>{if(t.confirm){const{result:t}=await $([e]);t&&(g({title:"删除成功",icon:"none"}),Q(Number(a.type)))}}})})(e.id)),["stop"])},null,8,["onClick"])])),_:2},1024)):k("v-if",!0)])),_:2},1024)])),_:2},1024),(i(!0),f(p,null,y(e.skus,(e=>(i(),c(l,{class:"center-y py-2",key:e.id},{default:d((()=>[b(s,{src:e.image,class:"h-20 w-20 mr-2"},null,8,["src"]),b(l,{class:"flex-1 h-16 flex justify-between flex-col"},{default:d((()=>[b(l,{class:"text-[#333] text-xs"},{default:d((()=>[v(_(e.name),1)])),_:2},1024),b(l,{class:"text-[#999] rounded-1 text-xs bg-[#f4f4f4] p-1 w-fit"},{default:d((()=>[v(_(e.attrsText),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),b(l,{class:"mt-1 text-[#999] text-sm flex justify-end b-bottom pb-2"},{default:d((()=>[b(l,{class:"mr-2"},{default:d((()=>[v("共"+_(e.totalNum)+"件商品",1)])),_:2},1024),b(l,null,{default:d((()=>[b(r,null,{default:d((()=>[v("实付")])),_:1}),b(r,{class:"text-xs"},{default:d((()=>[v("¥")])),_:1}),b(r,null,{default:d((()=>[v(_(e.totalMoney),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"]),b(l,{class:"flex justify-end pt-2"},{default:d((()=>[1==e.orderState?(i(),c(l,{key:0,class:"px-5 py-1 rounded-full text-white bg-[#fbb957]",onClick:t=>{return l=e.id,void w({content:"确认支付？",confirmColor:"#fbb957",async success(e){e.confirm&&(await getMockPayAPI(l),await Q(Number(a.type)))}});var l}},{default:d((()=>[v(" 去支付 ")])),_:2},1032,["onClick"])):k("v-if",!0),1!=e.orderState?(i(),c(l,{key:1,class:"px-4 py-1 rounded-full text-[#fbb957] border-1 border-solid border-[#fbb957]"},{default:d((()=>[v("再次购买 ")])),_:1})):k("v-if",!0),3==e.orderState?(i(),c(l,{key:2,class:"px-4 ml-2 py-1 rounded-full text-white bg-[#fbb957]",onClick:t=>{return l=e.id,void w({content:"确认收货？",confirmColor:"#fbb957",async success(e){e.confirm&&(await F(l),await Q(Number(a.type)))}});var l}},{default:d((()=>[v(" 确认收货 ")])),_:2},1032,["onClick"])):k("v-if",!0)])),_:2},1024)])),_:2},1024)))),128)),b(u,{status:m(T)},null,8,["status"])])),_:1})}}}),[["__scopeId","data-v-f5ceed20"]]),R=K(a({__name:"order-list",props:{type:null},setup(e){const a=[{type:"0",title:"全部"},{type:"1",title:"待付款"},{type:"2",title:"待发货"},{type:"3",title:"待收货"},{type:"4",title:"待评价"}],l=t(e.type||"0"),s=L();N((()=>{console.log(l.value),s.setCurrentType(l.value)}));const r=e=>{l.value=e.detail.current+""};return(e,t)=>{const s=h,u=Q,o=q,n=I;return i(),f(p,null,[b(s,{class:"relative"},{default:d((()=>[b(s,{class:"flex bg-white"},{default:d((()=>[(i(),f(p,null,y(a,(e=>b(s,{class:"flex-1 py-3 center",onClick:t=>{return a=e.type,void(l.value=a);var a},key:e.type},{default:d((()=>[v(_(e.title),1)])),_:2},1032,["onClick"]))),64))])),_:1}),b(s,{class:"absolute left-0 bottom-0 w-20% h-0.75 px-10 bg-[#fbb957] transition-all duration-400",style:T({left:20*Number(m(l))+"%"})},null,8,["style"])])),_:1}),b(n,{class:"h-[calc(100%-45px)]",current:Number(m(l)),circular:"",onChange:r},{default:d((()=>[(i(),f(p,null,y(a,(e=>b(o,{class:"h-full",key:e.type},{default:d((()=>[M(b(u,{type:e.type},null,8,["type"]),[[P,m(l)==e.type]])])),_:2},1024))),64))])),_:1},8,["current"])],64)}}}),[["__scopeId","data-v-adbdbc82"]]);export{R as default};