import{d as e,D as t,o as s,c as l,w as a,a as c,u as r,b as u,t as o,B as n,n as i,H as d,g as f,s as p,J as m,p as x,h as b,F as _,r as w,f as h,q as g,v as k,K as v,e as y,i as j}from"./index.1710046744346.js";import{g as L,p as C,d as I,a as F,_ as V}from"./cart.a8868f3b.js";import{_ as q,a as G}from"./uni-swipe-action.c33e036a.js";import{u as A,_ as E}from"./useAppGuessLike.eb2f1cda.js";import{_ as P}from"./app-scroll-view.25475bf7.js";import{u as R,_ as S}from"./plugin-vueexport-helper.6cd7b27f.js";import"./request.ff2c352d.js";import"./app-shop-item-v1.vuevuetypescriptsetuptruelang.0f0b6f40.js";import"./app-load-more.5bfbba66.js";import"./global.832d1848.js";import"./isObjectLike.53204146.js";import"./useSystem.fcc01766.js";const U=e({__name:"cart-nav-bar",props:{cartList:null},emits:["select-all"],setup(e,{emit:p}){const m=e,x=t((()=>m.cartList.filter((e=>e.selected)))),b=t((()=>x.value.reduce(((e,t)=>e+parseFloat(t.nowPrice)*t.count),0))),_=t((()=>0!=m.cartList.length&&x.value.length==m.cartList.length)),w=t((()=>x.value.reduce(((e,t)=>e+t.count),0))),h=()=>{p("select-all",!_.value)},g=()=>{0!=w.value&&i({url:"/sub-pages/order/order"})};return(t,i)=>{const p=d,m=f;return s(),l(m,{class:"fixed shadow-2xl b-bottom left-0 right-0 bottom-[var(--window-bottom)] h-[50px] bg-white box-border px-2 between"},{default:a((()=>[c(m,{class:"flex items-center"},{default:a((()=>[c(p,{style:{transform:"scale(0.9)"},disabled:0==e.cartList.length,color:"#fbb957",checked:r(_),onClick:h},{default:a((()=>[u(" 全选 ")])),_:1},8,["disabled","checked"]),c(m,{class:"flex ml-2 items-center"},{default:a((()=>[c(m,{class:"mr-2"},{default:a((()=>[u("合计: ")])),_:1}),c(m,{class:"mr-0.5 text-[#f00]"},{default:a((()=>[u(" ¥ ")])),_:1}),c(m,{class:"text-[#f00] text-lg"},{default:a((()=>[u(o(r(b).toFixed(2)),1)])),_:1})])),_:1})])),_:1}),c(m,{class:n(["text-white bg-[#fbb957] px-6 py-1.5 rounded-full text-sm",{"opacity-50":0==r(w)}]),onClick:g},{default:a((()=>[u(" 去结算 "+o(r(w)>0?`(${r(w)})`:""),1)])),_:1},8,["class"])])),_:1})}}}),B=S(e({__name:"cart",setup(e){const t=R(),{appGuessLikeRef:n,getMore:S}=A(),{user:B}=p(t);m((()=>{M()}));const D=()=>{i({url:"/pages/login/login"})},H=()=>{h({url:"/pages/home/home"})};async function J(e){await F(e.index,{count:e.value})}const K=x([]);async function M(){const{result:e}=await L();K.value=e}const O=e=>{K.value.forEach((t=>{t.selected=e})),C(e)};return(e,t)=>{const i=f,p=d,m=j,x=g(k("vk-data-input-number-box"),V),h=g(k("uni-swipe-action-item"),q),L=g(k("uni-swipe-action"),G),C=g(k("app-guess-like"),E),A=g(k("app-scroll-view"),P),R=U;return s(),b(_,null,[c(A,{"refresher-enabled":!1,scrolltolower:r(S),"padding-bottom":30},{default:a((()=>[c(i,{class:"pb-60px"},{default:a((()=>[r(B)?(s(),l(i,{key:1,class:"center py-4 flex-col mx-3"},{default:a((()=>[r(K).length>0?(s(),b(_,{key:0},[c(i,{class:"w-full pb-4"},{default:a((()=>[c(i,{class:"flex items-center text-xs w-full"},{default:a((()=>[c(i,{class:"bg-[#fbb957] w-fit text-white px-2 mr-2"},{default:a((()=>[u("满减")])),_:1}),c(i,{class:"text-[#666]"},{default:a((()=>[u("满1件,即可享受9折优惠")])),_:1})])),_:1})])),_:1}),c(i,{class:"w-full"},{default:a((()=>[c(L,null,{default:a((()=>[(s(!0),b(_,null,w(r(K),(e=>(s(),l(h,{class:"rounded-2",key:e.skuId},{right:a((()=>[c(i,{class:"bg-[#f00] text-white center px-4",onClick:t=>{return s=e.skuId,void v({content:"确定删除该商品吗？",confirmColor:"#fbb957",success:async e=>{e.confirm&&(await I(s),await M(),y({title:"删除成功",icon:"none"}))}});var s}},{default:a((()=>[u("删除")])),_:2},1032,["onClick"])])),default:a((()=>[c(i,{class:"mb-2"},{default:a((()=>[c(i,{class:"bg-white py-2 w-full flex items-center rounded-2"},{default:a((()=>[c(i,{class:"w-10 center"},{default:a((()=>[c(p,{class:"!w-10 center",onClick:t=>{return F((s=e).skuId,{selected:!s.selected}),void K.value.forEach((e=>{e.id==s.id&&(e.selected=!s.selected)}));var s},style:{transform:"scale(0.8)"},color:"#fbb957",value:e.id,checked:e.selected},null,8,["onClick","value","checked"])])),_:2},1024),c(i,{class:"between flex-1 box-border"},{default:a((()=>[c(m,{class:"w-24 h-24",mode:"aspectFill",src:e.picture},null,8,["src"]),c(i,{class:"flex-1 text-sm flex-col between items-start h-24 w-full box-border px-4"},{default:a((()=>[c(i,{class:"line-clamp-2"},{default:a((()=>[u(o(e.name),1)])),_:2},1024),c(i,{class:"w-full"},{default:a((()=>[c(i,{class:"bg-[#f7f7f8] px-2 py-0.25 text-[#999] mb-1 w-fit max-w-200px truncate"},{default:a((()=>[u(o(e.attrsText),1)])),_:2},1024),c(i,{class:"between w-full"},{default:a((()=>[c(i,{class:"text-[#f00] flex items-center"},{default:a((()=>[c(i,{class:"mr-0.5 text-xs"},{default:a((()=>[u(" ¥ ")])),_:1}),c(i,null,{default:a((()=>[u(o(e.nowPrice),1)])),_:2},1024)])),_:2},1024),c(x,{onChange:J,modelValue:e.count,"onUpdate:modelValue":t=>e.count=t,index:e.skuId,min:1,max:e.stock,step:1,"step-strictly":!0},null,8,["modelValue","onUpdate:modelValue","index","max"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})],64)):(s(),l(i,{key:1,class:"h-50vh center flex-col"},{default:a((()=>[c(i,{class:"mb-4 text-sm"},{default:a((()=>[u("购物车还是空的，快来挑选好货吧")])),_:1}),c(i,{class:"bg-[#fbb957] text-center px-12 py-1.5 w-fit rounded-full text-white",onClick:H},{default:a((()=>[u(" 去首页看看")])),_:1})])),_:1}))])),_:1})):(s(),l(i,{key:0,class:"h-50vh center flex-col"},{default:a((()=>[c(i,{class:"mb-4 text-sm"},{default:a((()=>[u("登录后可查看购物车中的商品")])),_:1}),c(i,{class:"bg-[#fbb957] text-center px-12 py-1.5 w-fit rounded-full text-white",onClick:D},{default:a((()=>[u("去登录")])),_:1})])),_:1})),c(i,{class:"mx-2"},{default:a((()=>[c(C,{ref_key:"appGuessLikeRef",ref:n},null,512)])),_:1})])),_:1})])),_:1},8,["scrolltolower"]),c(R,{onSelectAll:O,cartList:r(K)},null,8,["cartList"])],64)}}}),[["__scopeId","data-v-3a97498e"]]);export{B as default};